"use strict";

let _require = require('@babel/helper-module-imports'),
    addNamed = _require.addNamed;

let createPlugin = require('./macros-thing');

let _require2 = require('../../package.json'),
    name = _require2.name;

module.exports = createPlugin({
  [name]: function (_ref) {
    let babel = _ref.babel,
        references = _ref.references,
        state = _ref.state;
    const t = babel.types;

    if (references.importView) {
      let pathJoinIdentifier = addNamed(state.file.path, 'join', 'path');
      references.importView.forEach(reference => {
        reference.replaceWith(t.cloneNode(pathJoinIdentifier));
        reference.parentPath.node.arguments.unshift(t.identifier('__dirname'));
      });
    }
  }
});